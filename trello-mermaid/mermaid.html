<!DOCTYPE html>
<html>
<head>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.3.0/mermaid.min.js" integrity="sha512-FwnznVYc+d1qqPe2F+6IxQCa5j/3kCqUUgkJfMjP5r71sHNuDvQYn5h/aUkVwkh+Gihu5licMvcItyF06s5uRw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

      <style>
    body {
      margin: 0;
      padding: 0;
      overflow: auto;
    }
    .mermaid {
      margin: auto;
    }
  </style>
</head>
<body>
  <div id="mermaidChart"></div>
  <script>
    var t = TrelloPowerUp.iframe();
    mermaid.initialize({ startOnLoad: true });
    

    t.render(function() {
    return t.get('card', 'shared', 'mermaid')
        .then(function(mermaidCode) {
        console.log('Mermaid code:', mermaidCode);
        //document.getElementById('mermaidChart').innerHTML = mermaidCode;
        var insertSvg = function(svgCode, bindFunctions){
                    console.log('InsertSVG called:', svgCode);
                    document.getElementById('mermaidChart').innerHTML = svgCode;
                    t.sizeTo('#mermaidChart').done();
                };

        mermaid.mermaidAPI.render('uniqueId', mermaidCode, insertSvg);
        })
        .catch(function(error) {
        console.error('Failed to load Mermaid code:', error);
        });
    });
  </script>
</body>
</html>
